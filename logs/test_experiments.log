nohup: ignoring input
running mul_greedy_100_cds.py
[INFO] Output directory: /localdata/jonathan/PrimerDesigner/results/mul_greedy_experiment
[INFO] Reading protein coding sequences from: data/toy_input.txt
[INFO] Total proteins loaded: 3
[INFO] Processing protein 0/3: SHP2
Creating primer df
Creating graph
Creating primer df
Creating graph
Creating primer df
Creating graph
 Saved summary to: results/mul_greedy_experiment/summary.csv
 Saved per-protein metrics to: results/mul_greedy_experiment/per_protein_metrics.csv
 Saved paths to: results/mul_greedy_experiment/primers_per_protein.json
running mul_greedy.py
[INFO] Output directory: /localdata/jonathan/PrimerDesigner/results/mul_greedy_experiment
[INFO] Reading protein coding sequences from: data/toy_input.txt
[INFO] Total proteins loaded: 3

[INFO] Processing 2 protein(s)...
[INFO] Processing protein 0/2: SHP2
Creating primer df
Creating graph
Creating primer df
Creating graph
 Saved summary to: results/mul_greedy_experiment/summary.csv
 Saved per-protein metrics to: results/mul_greedy_experiment/per_protein_metrics.csv
 Saved paths to: results/mul_greedy_experiment/primers_per_protein.json
[INFO] Saved aggregate greedy results to: results/mul_greedy_experiment/greedy_results.csv
running mul_ILP.py
[INFO] Output directory: /localdata/jonathan/PrimerDesigner/results/mul_ILP_experiment
[INFO] Reading protein coding sequences from: data/toy_input.txt
[INFO] Total proteins loaded: 3

[INFO] Processing 2 protein(s)...
[STEP] Creating graphs for 2 proteins...
Creating Graph for protein:  0 Protein name:  SHP2
Creating primer df
Creating graph
Creating Graph for protein:  1 Protein name:  CXAR
Creating primer df
Creating graph
[DONE] Graphs created in 17.00 sec (peak 117.0 MB).
Finding forbidden pairs across proteins...
Finding intra-protein forbidden pairs constraints
[1/2] Processing SHP2...
[2/2] Processing CXAR...
Number of intra-protein forbidden pairs constraints:  0
Finding inter-protein forbidden pairs for 1 combinations...
[1/1] Fractions of pairs considered
Number of inter-protein forbidden pairs constraints:  0
[DONE] Forbidden pairs in 24.34 sec (single=0, inter=0).
[STEP] Running ILP model...
Creating ILP model...
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2499075
Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Adding constraints to ILP model...
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Rocky Linux 9.7 (Blue Onyx)")

CPU model: Intel(R) Xeon(R) Gold 6338 CPU @ 2.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 128 logical processors, using up to 32 threads

Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Optimize a model with 4632 rows, 280624 columns and 561248 nonzeros
Model fingerprint: 0x2c96fdfa
Variable types: 0 continuous, 280624 integer (280624 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [3e-04, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Found heuristic solution: objective -1.6015511
Presolve removed 4186 rows and 275156 columns
Presolve time: 0.88s
Presolved: 446 rows, 5468 columns, 10936 nonzeros
Found heuristic solution: objective 1.9686455
Variable types: 0 continuous, 5468 integer (5468 binary)
Performing another presolve...
Presolve removed 446 rows and 5468 columns
Presolve time: 0.01s

Explored 1 nodes (0 simplex iterations) in 1.19 seconds (1.56 work units)
Thread count was 32 (of 128 available processors)

Solution count 2: 1.96865 -1.60155 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.968645450850e+00, best bound 1.968645450850e+00, gap 0.0000%
Protein #SHP2 (2)
["(-80, -60, 'f')", "(106, 124, 'r')"]

Protein #CXAR (2)
["(-80, -60, 'f')", "(106, 124, 'r')"]

[DONE] ILP finished with status=2, objective=1.97, time=1.51 sec.
[SAVE] JSON saved → results/mul_ILP_experiment/paths_02_proteins.json
[DONE] Iteration 2 complete.

[SAVE] Aggregated CSV saved → results/mul_ILP_experiment/results_all_proteins.csv
[INFO] All iterations complete.
[TOTAL RUNTIME] 0.88 minutes (52.9 seconds total)
running var_ILP_length.py
[INFO] Output directory: /localdata/jonathan/PrimerDesigner/results/SPAP_var_ILP_lengths_experiment

[INFO] Running for sequence length: 226
[STEP 1] Creating primer DataFrame...
Creating primer df
               index                   seq  ... score_enddG  efficiency
start stop fr                               ...                        
-87   -69  f       0    GCTAGTGGTGCTAGCCCC  ...   -0.990885   -0.347798
           r       0    GGGGCTAGCACCACTAGC  ...   -1.000000   -0.349997
      -68  f     489   GCTAGTGGTGCTAGCCCCG  ...   -0.993517   -0.403519
           r     489   CGGGGCTAGCACCACTAGC  ...   -1.000000   -0.405192
      -67  f     977  GCTAGTGGTGCTAGCCCCGC  ...   -0.952070   -0.641191
...              ...                   ...  ...         ...         ...
 400   418 r     487    GGGCAGCTTGCCGGTGGT  ...   -0.999997   -0.706928
       419 f     976   ACCACCGGCAAGCTGCCCG  ...   -0.952070   -0.915091
           r     976   CGGGCAGCTTGCCGGTGGT  ...   -0.999997   -0.924685
 401   419 f     488    CCACCGGCAAGCTGCCCG  ...   -0.952070   -0.826350
           r     488    CGGGCAGCTTGCCGGTGG  ...   -0.999971   -0.835938

[12558 rows x 15 columns]
[STEP 2] Creating primer graph...
Creating graph
[STEP 3] Running greedy algorithm...
Running greedy algorithm
[STEP 4] Solving ILP model...
Running ILP
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2499075
Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Number of Constraints: 9412
Average Vars Per Constraint 82.84732256693583
Graph edges:  315096
Finished ILP Variable Creations
0
3
7
11
15
19
23
27
31
35
39
43
47
51
55
59
63
67
71
75
79
83
87
91
95
99
Finished Intersection constraints!
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Rocky Linux 9.7 (Blue Onyx)")

CPU model: Intel(R) Xeon(R) Gold 6338 CPU @ 2.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 128 logical processors, using up to 32 threads

Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Optimize a model with 13826 rows, 315096 columns and 54268643 nonzeros
Model fingerprint: 0x670d9852
Variable types: 0 continuous, 315096 integer (315096 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e-06, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+00]
Presolve removed 157 rows and 0 columns (presolve time = 5s)...
Presolve removed 170 rows and 13 columns (presolve time = 12s)...
Presolve removed 170 rows and 13 columns (presolve time = 15s)...
Presolve removed 1672 rows and 13 columns (presolve time = 23s)...
Presolve removed 1672 rows and 24 columns (presolve time = 25s)...
Presolve removed 1672 rows and 24 columns (presolve time = 30s)...
Presolve removed 1672 rows and 24 columns (presolve time = 39s)...
Presolve removed 1677 rows and 29 columns (presolve time = 42s)...
Presolve removed 1677 rows and 29 columns (presolve time = 46s)...
Presolve removed 1756 rows and 29 columns (presolve time = 50s)...
Presolve removed 1756 rows and 29 columns (presolve time = 55s)...
Presolve removed 1756 rows and 29 columns (presolve time = 60s)...
Presolve removed 8971 rows and 29 columns (presolve time = 65s)...
Presolve removed 8971 rows and 50 columns (presolve time = 70s)...
Presolve removed 8971 rows and 50 columns (presolve time = 75s)...
Presolve removed 8971 rows and 50 columns
Presolve time: 79.21s
Presolved: 4855 rows, 315046 columns, 7653917 nonzeros
Variable types: 0 continuous, 315046 integer (315046 binary)
Found heuristic solution: objective -4.7962880
Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 AA' NZ     : 5.558e+05
 Factor NZ  : 1.707e+06 (roughly 140 MB of memory)
 Factor Ops : 7.889e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82050998e+05  1.63416263e+05  6.44e+04 3.03e+02  1.17e+03    86s
   1  -2.82102512e+04  1.00807063e+05  1.03e+04 1.60e+02  2.30e+02    86s
   2  -3.13871530e+03  4.58243663e+04  1.18e+03 6.49e+01  5.26e+01    86s
   3  -1.91220131e+02  4.61797435e+03  7.08e+01 5.18e+00  4.61e+00    86s
   4  -5.01204178e+01  2.09705711e+03  1.84e+01 2.30e+00  1.93e+00    86s
   5  -1.05870639e+01  1.41250137e+03  3.45e+00 1.50e+00  1.19e+00    86s
   6  -3.45465260e+00  5.75601526e+02  7.33e-01 5.75e-01  4.78e-01    87s
   7  -2.45082912e+00  3.28030244e+02  3.29e-01 3.16e-01  2.72e-01    87s
   8  -1.75234481e+00  1.66286086e+02  8.45e-02 1.56e-01  1.37e-01    87s
   9  -5.01180213e-01  9.74979487e+01  4.20e-02 8.10e-02  8.00e-02    87s
  10  -1.15163523e-01  5.87388796e+01  3.42e-02 5.71e-02  4.81e-02    87s
  11   6.06155554e-01  5.48346034e+01  2.60e-02 5.13e-02  4.43e-02    87s
  12   1.64528489e+00  3.32316511e+01  1.67e-02 3.45e-02  2.58e-02    87s
  13   3.41710684e+00  1.18262309e+01  4.04e-03 8.07e-03  6.86e-03    88s
  14   4.19122310e+00  4.52315609e+00  9.78e-04 1.67e-12  2.77e-04    88s

Barrier performed 14 iterations in 87.67 seconds (147.02 work units)
Barrier solve interrupted - model solved by another algorithm

Concurrent spin time: 0.97s (can be avoided by choosing Method=3)

Solved with primal simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   18877    4.4923187e+00   0.000000e+00   0.000000e+00     88s

Root relaxation: objective 4.492319e+00, 18877 iterations, 5.53 seconds (6.88 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0       4.4923187    4.49232  0.00%     -   87s

Explored 1 nodes (18877 simplex iterations) in 88.00 seconds (147.08 work units)
Thread count was 32 (of 128 available processors)

Solution count 2: 4.49232 -4.79629 

Optimal solution found (tolerance 1.00e-04)
Best objective 4.492318663312e+00, best bound 4.492318663312e+00, gap 0.0000%
Protein #1 (6)
["(-86, -68, 'f')", "(88, 109, 'r')", "(59, 81, 'f')", "(225, 254, 'r')", "(204, 224, 'f')", "(386, 407, 'r')"]

Protein #2 (4)
["(-74, -54, 'f')", "(103, 126, 'r')", "(76, 95, 'f')", "(254, 273, 'r')"]

Protein #3 (4)
["(-58, -34, 'f')", "(122, 144, 'r')", "(95, 119, 'f')", "(272, 291, 'r')"]

Saved JSON paths: results/SPAP_var_ILP_lengths_experiment/paths_len_226.json

[ALL DONE] All sequence lengths processed successfully.
[TOTAL RUNTIME] 3.39 minutes (203.6 seconds total)
running var_ILP_num.py
[INFO] Output directory: /localdata/jonathan/PrimerDesigner/results/var_ILP_num_variants_experiment

[INFO] Running for num variants: 2
[STEP 1] Creating primer DataFrame...
Creating primer df
[STEP 2] Creating primer graph...
Creating graph
[STEP 3] Running greedy algorithm...
Running greedy algorithm
[STEP 4] Solving ILP model...
Running ILP
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2499075
Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Number of Constraints: 9412
Average Vars Per Constraint 82.84732256693583
Graph edges:  315096
Finished ILP Variable Creations
0
3
7
11
15
19
23
27
31
35
39
43
47
51
55
59
63
67
71
75
79
83
87
91
95
99
Finished Intersection constraints!
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Rocky Linux 9.7 (Blue Onyx)")

CPU model: Intel(R) Xeon(R) Gold 6338 CPU @ 2.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 128 logical processors, using up to 32 threads

Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Optimize a model with 13826 rows, 315096 columns and 54268643 nonzeros
Model fingerprint: 0x1b43976b
Variable types: 0 continuous, 315096 integer (315096 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [1e-06, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+00]
Presolve removed 0 rows and 0 columns (presolve time = 7s)...
Presolve removed 170 rows and 13 columns (presolve time = 12s)...
Presolve removed 170 rows and 13 columns (presolve time = 18s)...
Presolve removed 170 rows and 13 columns (presolve time = 23s)...
Presolve removed 1672 rows and 13 columns (presolve time = 29s)...
Presolve removed 1672 rows and 13 columns (presolve time = 34s)...
Presolve removed 1672 rows and 24 columns (presolve time = 35s)...
Presolve removed 1672 rows and 24 columns (presolve time = 40s)...
Presolve removed 1672 rows and 24 columns (presolve time = 45s)...
Presolve removed 1672 rows and 24 columns (presolve time = 57s)...
Presolve removed 1677 rows and 29 columns (presolve time = 61s)...
Presolve removed 1677 rows and 29 columns (presolve time = 68s)...
Presolve removed 1756 rows and 29 columns (presolve time = 70s)...
Presolve removed 1756 rows and 29 columns (presolve time = 75s)...
Presolve removed 1756 rows and 29 columns (presolve time = 80s)...
Presolve removed 1756 rows and 29 columns (presolve time = 85s)...
Presolve removed 8971 rows and 29 columns (presolve time = 92s)...
Presolve removed 8971 rows and 50 columns (presolve time = 98s)...
Presolve removed 8971 rows and 50 columns (presolve time = 100s)...
Presolve removed 8971 rows and 50 columns (presolve time = 105s)...
Presolve removed 8971 rows and 50 columns (presolve time = 110s)...
Presolve removed 8971 rows and 50 columns
Presolve time: 110.67s
Presolved: 4855 rows, 315046 columns, 7653917 nonzeros
Variable types: 0 continuous, 315046 integer (315046 binary)
Found heuristic solution: objective -2.7519061
Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 AA' NZ     : 5.558e+05
 Factor NZ  : 1.707e+06 (roughly 140 MB of memory)
 Factor Ops : 7.889e+08 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.48640200e+05  1.63416143e+05  5.26e+04 3.03e+02  9.84e+02   118s
   1  -2.43348540e+04  9.29360158e+04  8.83e+03 1.60e+02  2.02e+02   118s
   2  -2.48603048e+03  4.16101763e+04  9.33e+02 6.52e+01  4.60e+01   118s
   3  -1.60975602e+02  4.82750988e+03  6.08e+01 6.27e+00  4.66e+00   118s
   4  -4.23660296e+01  2.76442907e+03  1.59e+01 3.57e+00  2.44e+00   119s
   5  -8.87072317e+00  1.50479114e+03  3.04e+00 1.88e+00  1.26e+00   119s
   6  -2.18108880e+00  5.86409944e+02  5.63e-01 7.01e-01  4.85e-01   119s
   7  -1.23011844e+00  3.15943111e+02  2.29e-01 3.72e-01  2.60e-01   119s
   8  -7.47499631e-01  2.14452743e+02  1.42e-01 2.64e-01  1.77e-01   119s
   9  -3.79594289e-01  1.66370130e+02  7.28e-02 2.01e-01  1.36e-01   119s
  10  -5.29053611e-01  1.21724475e+02  6.52e-02 1.52e-01  1.00e-01   119s
  11   1.90975768e-02  1.18989998e+02  4.85e-02 1.49e-01  9.72e-02   119s
  12   4.81339306e-01  9.39031751e+01  3.09e-02 1.15e-01  7.62e-02   120s
  13   1.88385947e+00  2.77710873e+01  8.63e-03 4.13e-02  2.11e-02   120s
  14   3.44338832e+00  3.86781261e+00  3.61e-04 3.69e-12  3.48e-04   120s
  15   3.72687723e+00  3.73396386e+00  1.20e-06 1.53e-12  5.77e-06   120s
  16   3.73234273e+00  3.73234624e+00  6.66e-11 3.74e-12  2.85e-09   120s
  17   3.73234449e+00  3.73234449e+00  4.39e-12 3.24e-12  3.90e-13   120s

Barrier solved model in 17 iterations and 120.35 seconds (147.65 work units)
Optimal objective 3.73234449e+00


Root crossover log...

    4516 DPushes remaining with DInf 0.0000000e+00               120s
       0 DPushes remaining with DInf 0.0000000e+00               121s

       0 PPushes remaining with PInf 0.0000000e+00               121s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9738877e-11    121s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    4456    3.7323445e+00   0.000000e+00   0.000000e+00    121s
Concurrent spin time: 0.59s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 3.732344e+00, 4456 iterations, 6.71 seconds (7.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0       3.7323445    3.73234  0.00%     -  120s

Explored 1 nodes (4456 simplex iterations) in 121.04 seconds (147.84 work units)
Thread count was 32 (of 128 available processors)

Solution count 2: 3.73234 -2.75191 

Optimal solution found (tolerance 1.00e-04)
Best objective 3.732344492614e+00, best bound 3.732344492614e+00, gap 0.0000%
Protein #1 (6)
["(-86, -68, 'f')", "(88, 109, 'r')", "(59, 81, 'f')", "(225, 254, 'r')", "(204, 224, 'f')", "(386, 407, 'r')"]

Protein #2 (4)
["(-73, -50, 'f')", "(103, 126, 'r')", "(76, 95, 'f')", "(254, 273, 'r')"]

Saved JSON paths: results/var_ILP_num_variants_experiment/paths_2_variants.json

[ALL DONE] All sequence lengths processed successfully.
[TOTAL RUNTIME] 3.95 minutes (237.0 seconds total)
running var_ILP_proteins.py
[INFO] Output directory: /localdata/jonathan/PrimerDesigner/results/var_ILP_different_proteins_experiment
[INFO] Reading protein coding sequences from: data/toy_input.txt
[INFO] Total proteins loaded: 3

[INFO] Running for protein: SHP2. Protein length: 92
[STEP 1] Creating primer DataFrame...
Creating primer df
[STEP 2] Creating primer graph...
Creating graph
[STEP 3] Running greedy algorithm...
Running greedy algorithm
[STEP 4] Solving ILP model...
Running ILP
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2499075
Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Number of Constraints: 5088
Average Vars Per Constraint 79.63011006289308
Graph edges:  140312
Finished ILP Variable Creations
0
3
7
11
15
19
23
27
31
35
39
43
47
51
55
59
63
67
71
75
79
83
87
91
95
99
Finished Intersection constraints!
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Rocky Linux 9.7 (Blue Onyx)")

CPU model: Intel(R) Xeon(R) Gold 6338 CPU @ 2.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 128 logical processors, using up to 32 threads

Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Optimize a model with 7404 rows, 140312 columns and 24101714 nonzeros
Model fingerprint: 0x1c09674e
Variable types: 0 continuous, 140312 integer (140312 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [3e-04, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+00]
Presolve removed 144 rows and 26 columns (presolve time = 5s)...
Presolve removed 144 rows and 26 columns (presolve time = 10s)...
Presolve removed 1069 rows and 26 columns (presolve time = 17s)...
Presolve removed 1069 rows and 48 columns (presolve time = 20s)...
Presolve removed 1069 rows and 48 columns (presolve time = 25s)...
Presolve removed 1069 rows and 48 columns (presolve time = 32s)...
Presolve removed 1069 rows and 48 columns (presolve time = 35s)...
Presolve removed 3466 rows and 48 columns (presolve time = 40s)...
Presolve removed 3466 rows and 48 columns (presolve time = 45s)...
Presolve removed 3466 rows and 48 columns (presolve time = 50s)...
Presolve removed 3582 rows and 106 columns (presolve time = 55s)...
Presolve removed 3582 rows and 106 columns (presolve time = 60s)...
Presolve removed 3582 rows and 106 columns (presolve time = 65s)...
Presolve removed 3582 rows and 106 columns (presolve time = 70s)...
Presolve removed 3582 rows and 106 columns (presolve time = 75s)...
Presolve removed 3582 rows and 106 columns (presolve time = 80s)...
Presolve removed 3582 rows and 106 columns (presolve time = 85s)...
Sparsify removed 10132465 nonzeros (97%)
Presolve added 0 rows and 636 columns
Presolve removed 3632 rows and 0 columns
Presolve time: 87.48s
Presolved: 3772 rows, 140948 columns, 318983 nonzeros
Variable types: 143 continuous, 140805 integer (140389 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0   -5.2095167e-01   8.750000e+01   2.515551e+10     89s
Concurrent spin time: 0.04s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1418    1.7841392e+00   0.000000e+00   0.000000e+00     89s

Root relaxation: objective 1.784139e+00, 1418 iterations, 0.35 seconds (0.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0       1.7841392    1.78414  0.00%     -   88s

Explored 1 nodes (1418 simplex iterations) in 89.10 seconds (70.62 work units)
Thread count was 32 (of 128 available processors)

Solution count 1: 1.78414 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.784139215620e+00, best bound 1.784139215620e+00, gap 0.0000%
Protein #1 (4)
["(-86, -68, 'f')", "(91, 109, 'r')", "(59, 85, 'f')", "(236, 255, 'r')"]

Protein #2 (2)
["(-74, -54, 'f')", "(106, 124, 'r')"]

Protein #3 (2)
["(-58, -34, 'f')", "(120, 139, 'r')"]

Saved JSON paths: results/var_ILP_different_proteins_experiment/paths_protein_SHP2.json

[INFO] Running for protein: CXAR. Protein length: 92
[STEP 1] Creating primer DataFrame...
Creating primer df
[STEP 2] Creating primer graph...
Creating graph
[STEP 3] Running greedy algorithm...
Running greedy algorithm
[STEP 4] Solving ILP model...
Running ILP
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2499075
Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Number of Constraints: 5088
Average Vars Per Constraint 79.63011006289308
Graph edges:  140312
Finished ILP Variable Creations
0
3
7
11
15
19
23
27
31
35
39
43
47
51
55
59
63
67
71
75
79
83
87
91
95
99
Finished Intersection constraints!
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Rocky Linux 9.7 (Blue Onyx)")

CPU model: Intel(R) Xeon(R) Gold 6338 CPU @ 2.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 128 logical processors, using up to 32 threads

Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Optimize a model with 7404 rows, 140312 columns and 24101714 nonzeros
Model fingerprint: 0x97427650
Variable types: 0 continuous, 140312 integer (140312 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [3e-04, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+00]
Presolve removed 144 rows and 26 columns (presolve time = 5s)...
Presolve removed 1069 rows and 26 columns (presolve time = 10s)...
Presolve removed 1069 rows and 48 columns (presolve time = 15s)...
Presolve removed 1069 rows and 48 columns (presolve time = 21s)...
Presolve removed 3466 rows and 48 columns (presolve time = 25s)...
Presolve removed 3466 rows and 48 columns (presolve time = 30s)...
Presolve removed 3582 rows and 106 columns (presolve time = 35s)...
Presolve removed 3582 rows and 106 columns (presolve time = 40s)...
Presolve removed 3582 rows and 106 columns (presolve time = 45s)...
Presolve removed 3582 rows and 106 columns (presolve time = 51s)...
Presolve removed 3582 rows and 106 columns (presolve time = 55s)...
Presolve removed 3582 rows and 106 columns (presolve time = 60s)...
Sparsify removed 10132465 nonzeros (97%)
Presolve added 0 rows and 636 columns
Presolve removed 3632 rows and 0 columns
Presolve time: 62.38s
Presolved: 3772 rows, 140948 columns, 318983 nonzeros
Variable types: 143 continuous, 140805 integer (140389 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0   -4.8633415e-01   8.650000e+01   2.489413e+10     64s
Concurrent spin time: 0.04s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1410    1.8320161e+00   0.000000e+00   0.000000e+00     64s

Root relaxation: objective 1.832016e+00, 1410 iterations, 0.36 seconds (0.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0       1.8320161    1.83202  0.00%     -   63s

Explored 1 nodes (1410 simplex iterations) in 63.92 seconds (70.64 work units)
Thread count was 32 (of 128 available processors)

Solution count 1: 1.83202 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.832016140232e+00, best bound 1.832016140232e+00, gap 0.0000%
Protein #1 (4)
["(-86, -68, 'f')", "(91, 109, 'r')", "(59, 88, 'f')", "(236, 255, 'r')"]

Protein #2 (2)
["(-74, -54, 'f')", "(106, 124, 'r')"]

Protein #3 (2)
["(-58, -34, 'f')", "(120, 139, 'r')"]

Saved JSON paths: results/var_ILP_different_proteins_experiment/paths_protein_CXAR.json

[INFO] Running for protein: Rand. Protein length: 92
[STEP 1] Creating primer DataFrame...
Creating primer df
[STEP 2] Creating primer graph...
Creating graph
[STEP 3] Running greedy algorithm...
Running greedy algorithm
[STEP 4] Solving ILP model...
Running ILP
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2499075
Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Number of Constraints: 5088
Average Vars Per Constraint 79.63011006289308
Graph edges:  140312
Finished ILP Variable Creations
0
3
7
11
15
19
23
27
31
35
39
43
47
51
55
59
63
67
71
75
79
83
87
91
95
99
Finished Intersection constraints!
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Rocky Linux 9.7 (Blue Onyx)")

CPU model: Intel(R) Xeon(R) Gold 6338 CPU @ 2.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 128 logical processors, using up to 32 threads

Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Optimize a model with 7404 rows, 140312 columns and 24101714 nonzeros
Model fingerprint: 0x31f58a71
Variable types: 0 continuous, 140312 integer (140312 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [3e-04, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+00]
Presolve removed 144 rows and 26 columns (presolve time = 5s)...
Presolve removed 1069 rows and 26 columns (presolve time = 10s)...
Presolve removed 1069 rows and 48 columns (presolve time = 15s)...
Presolve removed 1069 rows and 48 columns (presolve time = 20s)...
Presolve removed 3466 rows and 48 columns (presolve time = 25s)...
Presolve removed 3466 rows and 48 columns (presolve time = 31s)...
Presolve removed 3582 rows and 106 columns (presolve time = 35s)...
Presolve removed 3582 rows and 106 columns (presolve time = 40s)...
Presolve removed 3582 rows and 106 columns (presolve time = 45s)...
Presolve removed 3582 rows and 106 columns (presolve time = 51s)...
Presolve removed 3582 rows and 106 columns (presolve time = 55s)...
Presolve removed 3582 rows and 106 columns (presolve time = 60s)...
Sparsify removed 10132465 nonzeros (97%)
Presolve added 0 rows and 636 columns
Presolve removed 3632 rows and 0 columns
Presolve time: 62.06s
Presolved: 3772 rows, 140948 columns, 318983 nonzeros
Variable types: 143 continuous, 140805 integer (140389 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0   -5.0125291e-02   8.687500e+01   2.990351e+10     63s
Concurrent spin time: 0.06s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1922    2.3752441e+00   0.000000e+00   0.000000e+00     63s

Root relaxation: objective 2.375244e+00, 1922 iterations, 0.39 seconds (0.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0       2.3752441    2.37524  0.00%     -   63s

Explored 1 nodes (1922 simplex iterations) in 63.63 seconds (70.67 work units)
Thread count was 32 (of 128 available processors)

Solution count 1: 2.37524 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.375244147729e+00, best bound 2.375244147729e+00, gap 0.0000%
Protein #1 (4)
["(-86, -68, 'f')", "(91, 110, 'r')", "(65, 84, 'f')", "(246, 268, 'r')"]

Protein #2 (2)
["(-74, -54, 'f')", "(106, 124, 'r')"]

Protein #3 (2)
["(-58, -34, 'f')", "(120, 139, 'r')"]

Saved JSON paths: results/var_ILP_different_proteins_experiment/paths_protein_Rand.json

[ALL DONE] All protein sequences processed successfully.
[TOTAL RUNTIME] 6.24 minutes (374.1 seconds total)
Running PD-single-LPath version
Saved selected primers to: results/PD_single_LPath_selected_primers.csv
Running PD-mul-IL version
[STEP] Creating graphs for 2 proteins...
Creating Graph for protein:  0 Protein name:  SHP2
Creating Graph for protein:  1 Protein name:  CXAR
[DONE] Graphs created in 17.00 sec (peak 117.0 MB).
[STEP] Finding forbidden pairs across proteins...
Finding intra-protein forbidden pairs constraints
[1/2] Processing SHP2...
[2/2] Processing CXAR...
Number of intra-protein forbidden pairs constraints:  0
Finding inter-protein forbidden pairs for 1 combinations...
[1/1] Fractions of pairs considered
Number of inter-protein forbidden pairs constraints:  0
[DONE] Forbidden pairs in 23.92 sec (intra=0, inter=0).
[STEP] Running ILP model...
Creating ILP model...
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2499075
Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Adding constraints to ILP model...
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Rocky Linux 9.7 (Blue Onyx)")

CPU model: Intel(R) Xeon(R) Gold 6338 CPU @ 2.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 128 logical processors, using up to 32 threads

Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Optimize a model with 4632 rows, 280624 columns and 561248 nonzeros
Model fingerprint: 0x2c96fdfa
Variable types: 0 continuous, 280624 integer (280624 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [3e-04, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+00]
Found heuristic solution: objective -1.6015511
Presolve removed 4186 rows and 275156 columns
Presolve time: 0.73s
Presolved: 446 rows, 5468 columns, 10936 nonzeros
Found heuristic solution: objective 1.9686455
Variable types: 0 continuous, 5468 integer (5468 binary)
Performing another presolve...
Presolve removed 446 rows and 5468 columns
Presolve time: 0.01s

Explored 1 nodes (0 simplex iterations) in 0.81 seconds (1.56 work units)
Thread count was 32 (of 128 available processors)

Solution count 2: 1.96865 -1.60155 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.968645450850e+00, best bound 1.968645450850e+00, gap 0.0000%
Protein #SHP2 (2)
["(-80, -60, 'f')", "(106, 124, 'r')"]

Protein #CXAR (2)
["(-80, -60, 'f')", "(106, 124, 'r')"]

[DONE] ILP status=2, objective=1.97, time=1.04 sec.
[SAVE] Appended summary → results/mul_ilp_results.csv
[SAVE] Primer paths CSV → results/mul_ilp_selected_primers.csv
Running PD-var-ILP version
Running greedy algorithm
Running ILP
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2499075
Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Number of Constraints: 5088
Average Vars Per Constraint 79.63011006289308
Graph edges:  140312
Finished ILP Variable Creations
0
3
7
11
15
19
23
27
31
35
39
43
47
51
55
59
63
67
71
75
79
83
87
91
95
99
Finished Intersection constraints!
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Rocky Linux 9.7 (Blue Onyx)")

CPU model: Intel(R) Xeon(R) Gold 6338 CPU @ 2.00GHz, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 128 logical processors, using up to 32 threads

Academic license 2499075 - for non-commercial use only - registered to jo___@live.biu.ac.il
Optimize a model with 7404 rows, 140312 columns and 24101714 nonzeros
Model fingerprint: 0x1c09674e
Variable types: 0 continuous, 140312 integer (140312 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+00]
  Objective range  [3e-04, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+00]
Presolve removed 144 rows and 26 columns (presolve time = 5s)...
Presolve removed 1069 rows and 26 columns (presolve time = 10s)...
Presolve removed 1069 rows and 48 columns (presolve time = 15s)...
Presolve removed 1069 rows and 48 columns (presolve time = 20s)...
Presolve removed 3466 rows and 48 columns (presolve time = 25s)...
Presolve removed 3466 rows and 48 columns (presolve time = 30s)...
Presolve removed 3582 rows and 106 columns (presolve time = 35s)...
Presolve removed 3582 rows and 106 columns (presolve time = 40s)...
Presolve removed 3582 rows and 106 columns (presolve time = 45s)...
Presolve removed 3582 rows and 106 columns (presolve time = 50s)...
Presolve removed 3582 rows and 106 columns (presolve time = 55s)...
Sparsify removed 10132465 nonzeros (97%)
Presolve removed 3690 rows and 1012 columns (presolve time = 60s)...
Presolve added 0 rows and 636 columns
Presolve removed 3632 rows and 0 columns
Presolve time: 60.31s
Presolved: 3772 rows, 140948 columns, 318983 nonzeros
Variable types: 143 continuous, 140805 integer (140389 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
       0   -5.2095167e-01   8.750000e+01   2.515551e+10     61s
Concurrent spin time: 0.04s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
    1418    1.7841392e+00   0.000000e+00   0.000000e+00     62s

Root relaxation: objective 1.784139e+00, 1418 iterations, 0.34 seconds (0.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

*    0     0               0       1.7841392    1.78414  0.00%     -   61s

Explored 1 nodes (1418 simplex iterations) in 61.79 seconds (70.62 work units)
Thread count was 32 (of 128 available processors)

Solution count 1: 1.78414 

Optimal solution found (tolerance 1.00e-04)
Best objective 1.784139215620e+00, best bound 1.784139215620e+00, gap 0.0000%
Protein #1 (4)
["(-86, -68, 'f')", "(91, 109, 'r')", "(59, 85, 'f')", "(236, 255, 'r')"]

Protein #2 (2)
["(-74, -54, 'f')", "(106, 124, 'r')"]

Protein #3 (2)
["(-58, -34, 'f')", "(120, 139, 'r')"]

Saved summary to: results/var_ILP_results.csv
Saved ILP selected primers to: results/var_ILP_selected_primers_ILP.csv
Saved greedy selected primers to: results/var_ILP_selected_primers_greedy.csv
Running PD-mul-Greedy version
[INFO] Processing protein 0/2: SHP2
[SAVE] Selected primers CSV → results/PD_mul_Greedy_selected_primers.csv
